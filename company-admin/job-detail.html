<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Details - Bizoforce Platform</title>
    <link rel="stylesheet" href="../assets/css/dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="sidebar-logo-img">
                <div class="sidebar-logo-icon">B</div>
                <div class="sidebar-logo-text">Bizoforce</div>
            </div>
        </div>
        <nav class="sidebar-menu">
            <!-- Menu generated by JavaScript -->
        </nav>
    </aside>

    <!-- Top Bar -->
    <header class="top-bar">
        <div class="search-bar">
            <button class="btn btn-secondary btn-sm" onclick="history.back()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Jobs
            </button>
        </div>
        <div class="user-section">
            <div class="wallet">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                </svg>
                <span>$12,450</span>
            </div>
            <div class="notifications">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                </svg>
                <span class="badge">8</span>
            </div>
            <div class="user-avatar">
                <img src="https://i.pravatar.cc/150?img=1" alt="User">
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <div class="content-grid">
            <!-- Left Column - Job Details -->
            <div>
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h1>Senior Full Stack Developer</h1>
                            <div style="display: flex; gap: 12px; align-items: center; margin-top: 8px;">
                                <span class="job-type-badge full-time">Full-time</span>
                                <span class="status-badge active">Active</span>
                                <span style="color: var(--text-gray);">Posted: Nov 10, 2025</span>
                            </div>
                        </div>
                        <button class="btn btn-primary">Edit Job</button>
                    </div>
                    <div class="card-body">
                        <div style="display: flex; gap: 32px; margin-bottom: 24px;">
                            <div class="company-info">
                                <img src="https://via.placeholder.com/48" alt="TechCorp" class="company-logo">
                                <div>
                                    <div class="company-name">TechCorp Solutions</div>
                                    <div class="company-email">San Francisco, CA</div>
                                </div>
                            </div>
                            <div>
                                <div style="font-size: 13px; color: var(--text-gray);">Salary Range</div>
                                <div style="font-size: 18px; font-weight: 700; color: var(--primary-blue);">$120,000 - $150,000/year</div>
                            </div>
                        </div>

                        <h3 style="margin-bottom: 12px;">Job Description</h3>
                        <p style="color: var(--text-gray); line-height: 1.6; margin-bottom: 24px;">
                            We are seeking an experienced Senior Full Stack Developer to join our growing team. You will be responsible for developing and maintaining web applications, working with both front-end and back-end technologies, and collaborating with cross-functional teams to deliver high-quality software solutions.
                        </p>

                        <h3 style="margin-bottom: 12px;">Requirements</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8; margin-bottom: 24px; padding-left: 20px;">
                            <li>5+ years of experience in full-stack development</li>
                            <li>Strong proficiency in JavaScript, React, and Node.js</li>
                            <li>Experience with database design (PostgreSQL, MongoDB)</li>
                            <li>Knowledge of cloud platforms (AWS, Azure, or GCP)</li>
                            <li>Excellent problem-solving and communication skills</li>
                        </ul>

                        <h3 style="margin-bottom: 12px;">Benefits</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8; padding-left: 20px;">
                            <li>Competitive salary and equity package</li>
                            <li>Health, dental, and vision insurance</li>
                            <li>401(k) matching</li>
                            <li>Flexible work hours and remote options</li>
                            <li>Professional development opportunities</li>
                        </ul>
                    </div>
                </div>

                <!-- Applications Table -->
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <h2>Applications (45)</h2>
                        <div class="filter-controls">
                            <select class="form-select" id="statusFilter">
                                <option value="">All Statuses</option>
                                <option value="applied">Applied</option>
                                <option value="screening">AI Screening</option>
                                <option value="interview">Interview Scheduled</option>
                                <option value="offer">Offer Extended</option>
                                <option value="hired">Hired</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="applicationsTable">
                            <thead>
                                <tr>
                                    <th>Candidate</th>
                                    <th>Applied Date</th>
                                    <th>AI Score</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="applicationsTableBody">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Right Column - Stats -->
            <div>
                <div class="card">
                    <div class="card-header">
                        <h3>Application Statistics</h3>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 13px; color: var(--text-gray);">Total Applications</div>
                            <div style="font-size: 32px; font-weight: 700; color: var(--text-dark);">45</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 13px; color: var(--text-gray);">Pending Review</div>
                            <div style="font-size: 32px; font-weight: 700; color: var(--warning);">23</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 13px; color: var(--text-gray);">Shortlisted</div>
                            <div style="font-size: 32px; font-weight: 700; color: var(--success);">15</div>
                        </div>
                        <div>
                            <div style="font-size: 13px; color: var(--text-gray);">Rejected</div>
                            <div style="font-size: 32px; font-weight: 700; color: var(--danger);">7</div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <h3>Quick Actions</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" style="width: 100%; margin-bottom: 12px;">Close Job Posting</button>
                        <button class="btn btn-secondary" style="width: 100%; margin-bottom: 12px;">Share Job</button>
                        <button class="btn btn-secondary" style="width: 100%;">Export Applications</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Interview Scheduling Modal -->
    <div class="modal" id="interviewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Schedule AI Interview</h2>
                <button class="close-modal" onclick="closeModal('interviewModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: var(--text-gray);">
                    Interview questions will be auto-generated from the job description. All candidates for this job will receive the same questions.
                </p>
                
                <div class="form-group">
                    <label class="form-label">Candidate Email</label>
                    <input type="email" id="interviewCandidateEmail" class="form-input" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">Interview Duration</label>
                    <select id="interviewDuration" class="form-input">
                        <option value="30">30 minutes</option>
                        <option value="45" selected>45 minutes</option>
                        <option value="60">60 minutes</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Interview Deadline</label>
                    <input type="datetime-local" id="interviewDeadline" class="form-input" required>
                </div>

                <div class="info-card" style="background: #eff6ff; border-left: 4px solid var(--primary-blue);">
                    <p style="margin: 0; font-size: 14px; color: var(--text-dark);">
                        <strong>Auto-Generated Questions Preview:</strong><br>
                        Questions will be generated based on job requirements (JavaScript, React, Node.js, database design, etc.)
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('interviewModal')">Cancel</button>
                <button class="btn btn-primary" onclick="sendInterviewInvite()">Send Interview Invite</button>
            </div>
        </div>
    </div>

    <!-- Offer Management Modal -->
    <div class="modal" id="offerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Extend Job Offer</h2>
                <button class="close-modal" onclick="closeModal('offerModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Candidate Email</label>
                    <input type="email" id="offerCandidateEmail" class="form-input" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">Job Title</label>
                    <input type="text" id="offerJobTitle" class="form-input" value="Senior Full Stack Developer" readonly>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Salary Offer</label>
                        <input type="number" id="offerSalary" class="form-input" placeholder="$120,000" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Employment Type</label>
                        <select id="offerEmploymentType" class="form-input">
                            <option value="full-time">Full-time</option>
                            <option value="part-time">Part-time</option>
                            <option value="contract">Contract</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Start Date</label>
                    <input type="date" id="offerStartDate" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Additional Benefits</label>
                    <textarea id="offerBenefits" class="form-input" rows="4" placeholder="Health insurance, 401k matching, equity, etc."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Offer Valid Until</label>
                    <input type="date" id="offerValidUntil" class="form-input" required>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('offerModal')">Cancel</button>
                <button class="btn btn-primary" onclick="sendOffer()">Send Offer</button>
            </div>
        </div>
    </div>

    <!-- View Screening Results Modal -->
    <div class="modal" id="screeningModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">AI Screening Results</h2>
                <button class="close-modal" onclick="closeModal('screeningModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; gap: 24px; margin-bottom: 24px;">
                    <div class="info-card" style="flex: 1;">
                        <div class="info-label">Overall Score</div>
                        <div class="info-value" id="screeningScore" style="font-size: 36px; color: var(--success);">92%</div>
                    </div>
                    <div class="info-card" style="flex: 1;">
                        <div class="info-label">Skills Match</div>
                        <div class="info-value" id="skillsMatch" style="font-size: 36px; color: var(--primary-blue);">8/10</div>
                    </div>
                    <div class="info-card" style="flex: 1;">
                        <div class="info-label">Experience Match</div>
                        <div class="info-value" id="experienceMatch" style="font-size: 36px; color: var(--warning);">7 yrs</div>
                    </div>
                </div>

                <h3 style="margin-bottom: 12px;">Key Highlights</h3>
                <ul style="color: var(--text-gray); line-height: 1.8; margin-bottom: 24px;">
                    <li>Strong proficiency in required technologies (React, Node.js, PostgreSQL)</li>
                    <li>7+ years of full-stack development experience</li>
                    <li>Previous experience with cloud platforms (AWS)</li>
                    <li>Excellent communication skills based on resume analysis</li>
                </ul>

                <h3 style="margin-bottom: 12px;">Areas of Concern</h3>
                <ul style="color: var(--text-gray); line-height: 1.8;">
                    <li>Limited MongoDB experience (only PostgreSQL background)</li>
                    <li>No explicit mention of GCP or Azure experience</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('screeningModal')">Close</button>
                <button class="btn btn-primary" onclick="proceedToInterview()">Schedule Interview</button>
            </div>
        </div>
    </div>

    <script src="../assets/js/dashboard.js"></script>
    <script>
        // Set user type for navigation
        localStorage.setItem('userType', 'company');
        generateNavigation('jobs');

        // ============================================
        // APPLICATION DATA & STATE MANAGEMENT
        // ============================================

        // Check if company has Screenly subscription
        const hasScreenlySubscription = localStorage.getItem('screenlySubscription') === 'true' || true; // Default true for demo

        // Sample applications data
        let applications = [
            {
                id: 1,
                name: 'John Smith',
                email: 'john.smith@email.com',
                avatar: 'https://i.pravatar.cc/150?img=2',
                appliedDate: 'Nov 11, 2025',
                experience: '7 years',
                aiScore: 92,
                status: 'applied',
                screeningCompleted: false,
                interviewScheduled: false,
                offerExtended: false
            },
            {
                id: 2,
                name: 'Sarah Johnson',
                email: 'sarah.j@email.com',
                avatar: 'https://i.pravatar.cc/150?img=3',
                appliedDate: 'Nov 10, 2025',
                experience: '6 years',
                aiScore: 88,
                status: 'screening',
                screeningCompleted: false,
                interviewScheduled: false,
                offerExtended: false
            },
            {
                id: 3,
                name: 'Michael Chen',
                email: 'michael.chen@email.com',
                avatar: 'https://i.pravatar.cc/150?img=4',
                appliedDate: 'Nov 9, 2025',
                experience: '8 years',
                aiScore: 95,
                status: 'interview',
                screeningCompleted: true,
                interviewScheduled: true,
                offerExtended: false
            },
            {
                id: 4,
                name: 'Emily Davis',
                email: 'emily.davis@email.com',
                avatar: 'https://i.pravatar.cc/150?img=5',
                appliedDate: 'Nov 8, 2025',
                experience: '5 years',
                aiScore: 85,
                status: 'offer',
                screeningCompleted: true,
                interviewScheduled: true,
                offerExtended: true
            }
        ];

        let currentCandidate = null;

        // ============================================
        // INITIALIZE PAGE
        // ============================================

        document.addEventListener('DOMContentLoaded', function() {
            renderApplications();
            setupFilterListener();
            
            // Auto-trigger AI screening for newly applied candidates (if Screenly subscription active)
            if (hasScreenlySubscription) {
                autoTriggerAIScreening();
            }
        });

        // ============================================
        // RENDER APPLICATIONS TABLE
        // ============================================

        function renderApplications(filterStatus = '') {
            const tbody = document.getElementById('applicationsTableBody');
            const filteredApps = filterStatus ? 
                applications.filter(app => app.status === filterStatus) : 
                applications;
            
            tbody.innerHTML = filteredApps.map(app => `
                <tr>
                    <td>
                        <div class="company-info">
                            <img src="${app.avatar}" alt="${app.name}" class="company-logo">
                            <div>
                                <div class="company-name">${app.name}</div>
                                <div class="company-email">${app.email}</div>
                            </div>
                        </div>
                    </td>
                    <td>${app.appliedDate}</td>
                    <td>
                        ${app.screeningCompleted ? 
                            `<span style="color: var(--success); font-weight: 600;">${app.aiScore}%</span>` : 
                            `<span style="color: var(--text-gray);">Pending</span>`
                        }
                    </td>
                    <td>${getStatusBadge(app.status)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon" onclick="viewCandidate(${app.id})" title="View Profile">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                </svg>
                            </button>
                            ${getActionButtons(app)}
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusBadge(status) {
            const badges = {
                'applied': '<span class="status-badge pending">Applied</span>',
                'screening': '<span class="status-badge warning" style="background: #8b5cf6;">AI Screening</span>',
                'interview': '<span class="status-badge warning">Interview Scheduled</span>',
                'offer': '<span class="status-badge info">Offer Extended</span>',
                'hired': '<span class="status-badge active">Hired</span>',
                'rejected': '<span class="status-badge danger">Rejected</span>'
            };
            return badges[status] || badges['applied'];
        }

        function getActionButtons(app) {
            let buttons = '';
            
            // Show screening results if completed
            if (app.screeningCompleted) {
                buttons += `
                    <button class="btn-icon" onclick="viewScreeningResults(${app.id})" title="View Screening" style="color: var(--primary-blue);">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                        </svg>
                    </button>
                `;
            }
            
            // Show schedule interview if screening completed and not yet scheduled
            if (app.screeningCompleted && !app.interviewScheduled) {
                buttons += `
                    <button class="btn-icon success" onclick="scheduleInterview(${app.id})" title="Schedule Interview">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                        </svg>
                    </button>
                `;
            }
            
            // Show extend offer if interview completed and no offer yet
            if (app.interviewScheduled && !app.offerExtended && app.status !== 'offer') {
                buttons += `
                    <button class="btn-icon" onclick="extendOffer(${app.id})" title="Extend Offer" style="color: var(--success);">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
                        </svg>
                    </button>
                `;
            }
            
            // Reject button (always available)
            buttons += `
                <button class="btn-icon danger" onclick="rejectCandidate(${app.id})" title="Reject">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            `;
            
            return buttons;
        }

        // ============================================
        // AI SCREENING (AUTO-TRIGGERED)
        // ============================================

        function autoTriggerAIScreening() {
            // Find candidates who just applied and haven't been screened yet
            const newApplicants = applications.filter(app => 
                app.status === 'applied' && !app.screeningCompleted
            );
            
            newApplicants.forEach(app => {
                // Simulate AI screening process
                setTimeout(() => {
                    runAIScreening(app.id);
                }, 2000); // 2 second delay per candidate
            });
        }

        function runAIScreening(candidateId) {
            const candidate = applications.find(app => app.id === candidateId);
            if (!candidate) return;
            
            console.log(`ðŸ¤– Running AI Screening for ${candidate.name}...`);
            
            // Simulate Screenly AI analysis
            candidate.status = 'screening';
            renderApplications();
            
            // Simulate screening completion (3 seconds)
            setTimeout(() => {
                candidate.screeningCompleted = true;
                candidate.aiScore = Math.floor(Math.random() * 20) + 80; // 80-100 score
                candidate.status = 'screening';
                
                console.log(`âœ… AI Screening completed for ${candidate.name}: ${candidate.aiScore}%`);
                renderApplications();
                
                // Show notification
                showNotification(`AI Screening completed for ${candidate.name} - Score: ${candidate.aiScore}%`, 'success');
            }, 3000);
        }

        function viewScreeningResults(candidateId) {
            currentCandidate = applications.find(app => app.id === candidateId);
            if (!currentCandidate) return;
            
            document.getElementById('screeningScore').textContent = currentCandidate.aiScore + '%';
            openModal('screeningModal');
        }

        function proceedToInterview() {
            closeModal('screeningModal');
            scheduleInterview(currentCandidate.id);
        }

        // ============================================
        // INTERVIEW SCHEDULING
        // ============================================

        function scheduleInterview(candidateId) {
            currentCandidate = applications.find(app => app.id === candidateId);
            if (!currentCandidate) return;
            
            document.getElementById('interviewCandidateEmail').value = currentCandidate.email;
            
            // Set default deadline (7 days from now)
            const deadline = new Date();
            deadline.setDate(deadline.getDate() + 7);
            document.getElementById('interviewDeadline').value = deadline.toISOString().slice(0, 16);
            
            openModal('interviewModal');
        }

        function sendInterviewInvite() {
            const duration = document.getElementById('interviewDuration').value;
            const deadline = document.getElementById('interviewDeadline').value;
            
            if (!deadline) {
                alert('Please select an interview deadline');
                return;
            }
            
            // Update candidate status
            currentCandidate.interviewScheduled = true;
            currentCandidate.status = 'interview';
            
            // Store interview questions (auto-generated from job description)
            const jobTitle = 'Senior Full Stack Developer';
            const interviewQuestions = generateInterviewQuestions(jobTitle);
            
            // Save to localStorage
            localStorage.setItem(`interview_${currentCandidate.id}`, JSON.stringify({
                candidateId: currentCandidate.id,
                duration,
                deadline,
                questions: interviewQuestions,
                status: 'scheduled'
            }));
            
            console.log(`ðŸ“§ Interview invite sent to ${currentCandidate.email}`);
            console.log(`ðŸ“ Questions generated:`, interviewQuestions);
            
            closeModal('interviewModal');
            renderApplications();
            showNotification(`Interview scheduled for ${currentCandidate.name}`, 'success');
        }

        function generateInterviewQuestions(jobTitle) {
            // Auto-generate questions based on job description
            // In production, this would use Screenly AI API
            return [
                {
                    id: 1,
                    question: 'Describe your experience with React and modern JavaScript frameworks.',
                    type: 'technical',
                    timeLimit: 5
                },
                {
                    id: 2,
                    question: 'Explain how you would design a scalable Node.js backend architecture.',
                    type: 'technical',
                    timeLimit: 5
                },
                {
                    id: 3,
                    question: 'Walk me through your approach to database design and optimization.',
                    type: 'technical',
                    timeLimit: 5
                },
                {
                    id: 4,
                    question: 'How do you handle deployment and monitoring on cloud platforms like AWS?',
                    type: 'technical',
                    timeLimit: 5
                },
                {
                    id: 5,
                    question: 'Tell me about a challenging problem you solved recently and your approach.',
                    type: 'behavioral',
                    timeLimit: 5
                }
            ];
        }

        // ============================================
        // OFFER MANAGEMENT
        // ============================================

        function extendOffer(candidateId) {
            currentCandidate = applications.find(app => app.id === candidateId);
            if (!currentCandidate) return;
            
            document.getElementById('offerCandidateEmail').value = currentCandidate.email;
            
            // Set default offer valid date (14 days from now)
            const validDate = new Date();
            validDate.setDate(validDate.getDate() + 14);
            document.getElementById('offerValidUntil').value = validDate.toISOString().slice(0, 10);
            
            openModal('offerModal');
        }

        function sendOffer() {
            const salary = document.getElementById('offerSalary').value;
            const employmentType = document.getElementById('offerEmploymentType').value;
            const startDate = document.getElementById('offerStartDate').value;
            const benefits = document.getElementById('offerBenefits').value;
            const validUntil = document.getElementById('offerValidUntil').value;
            
            if (!salary || !startDate || !validUntil) {
                alert('Please fill all required fields');
                return;
            }
            
            // Update candidate status
            currentCandidate.offerExtended = true;
            currentCandidate.status = 'offer';
            
            // Save offer details
            localStorage.setItem(`offer_${currentCandidate.id}`, JSON.stringify({
                candidateId: currentCandidate.id,
                candidateEmail: currentCandidate.email,
                candidateName: currentCandidate.name,
                salary,
                employmentType,
                startDate,
                benefits,
                validUntil,
                status: 'pending',
                sentDate: new Date().toISOString()
            }));
            
            console.log(`ðŸ’¼ Offer extended to ${currentCandidate.email}`);
            console.log(`   Salary: $${salary}, Type: ${employmentType}`);
            
            closeModal('offerModal');
            renderApplications();
            showNotification(`Offer sent to ${currentCandidate.name}`, 'success');
        }

        // ============================================
        // OFFER ACCEPTANCE & AUTO-CREATE PROJECT
        // ============================================

        function handleOfferAcceptance(candidateId) {
            const candidate = applications.find(app => app.id === candidateId);
            if (!candidate) return;
            
            // Update status to hired
            candidate.status = 'hired';
            renderApplications();
            
            // Auto-create project
            autoCreateProject(candidate);
            
            showNotification(`${candidate.name} has been hired! Project created automatically.`, 'success');
        }

        function autoCreateProject(candidate) {
            const offer = JSON.parse(localStorage.getItem(`offer_${candidate.id}`));
            
            const newProject = {
                id: Date.now(),
                name: `${candidate.name} - Onboarding Project`,
                client: 'Internal',
                teamMembers: [
                    {
                        id: candidate.id,
                        name: candidate.name,
                        email: candidate.email,
                        role: offer.employmentType,
                        hourlyRate: calculateHourlyRate(offer.salary, offer.employmentType)
                    }
                ],
                status: 'active',
                startDate: offer.startDate,
                budget: offer.salary,
                createdDate: new Date().toISOString(),
                createdBy: 'Hiring System',
                autoCreated: true
            };
            
            // Save to projects
            let projects = JSON.parse(localStorage.getItem('projects') || '[]');
            projects.push(newProject);
            localStorage.setItem('projects', JSON.stringify(projects));
            
            console.log(`âœ… Project auto-created for ${candidate.name}:`, newProject);
        }

        function calculateHourlyRate(annualSalary, employmentType) {
            if (employmentType === 'full-time') {
                return Math.round((parseFloat(annualSalary) / 52 / 40) * 100) / 100;
            }
            return 0; // For part-time/contract, set manually
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        function viewCandidate(candidateId) {
            window.location.href = `candidate-detail.html?id=${candidateId}`;
        }

        function rejectCandidate(candidateId) {
            if (confirm('Are you sure you want to reject this candidate?')) {
                const candidate = applications.find(app => app.id === candidateId);
                candidate.status = 'rejected';
                renderApplications();
                showNotification(`${candidate.name} has been rejected`, 'info');
            }
        }

        function setupFilterListener() {
            document.getElementById('statusFilter').addEventListener('change', (e) => {
                renderApplications(e.target.value);
            });
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showNotification(message, type) {
            console.log(`[${type.toUpperCase()}] ${message}`);
            // In production, use a proper notification system
        }

        // Simulate offer acceptance from candidate side (for demo)
        window.simulateOfferAcceptance = function(candidateId) {
            handleOfferAcceptance(candidateId);
        };
    </script>
</body>
</html>